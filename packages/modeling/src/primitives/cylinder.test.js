const test = require('ava')

const geom3 = require('../geometry/geom3')

const {cylinder} = require('./index')

const comparePolygonsAsPoints = require('../../test/helpers/comparePolygonsAsPoints')

test('cylinder (defaults)', t => {
  const obs = cylinder()
  const pts = geom3.toPoints(obs)
  const exp = [
    [ [ 0, 0, -1 ],
      [ 1, 0, -1 ],
      [ 0.8660253882408142, -0.5, -1 ] ],
    [ [ 0.8660253882408142, -0.5, -1 ],
      [ 1, 0, -1 ],
      [ 1, 0, 1 ],
      [ 0.8660253882408142, -0.5, 1 ] ],
    [ [ 0, 0, 1 ],
      [ 0.8660253882408142, -0.5, 1 ],
      [ 1, 0, 1 ] ],
    [ [ 0, 0, -1 ],
      [ 0.8660253882408142, -0.5, -1 ],
      [ 0.5, -0.8660253882408142, -1 ] ],
    [ [ 0.5, -0.8660253882408142, -1 ],
      [ 0.8660253882408142, -0.5, -1 ],
      [ 0.8660253882408142, -0.5, 1 ],
      [ 0.5, -0.8660253882408142, 1 ] ],
    [ [ 0, 0, 1 ],
      [ 0.5, -0.8660253882408142, 1 ],
      [ 0.8660253882408142, -0.5, 1 ] ],
    [ [ 0, 0, -1 ],
      [ 0.5, -0.8660253882408142, -1 ],
      [ 6.123234262925839e-17, -1, -1 ] ],
    [ [ 6.123234262925839e-17, -1, -1 ],
      [ 0.5, -0.8660253882408142, -1 ],
      [ 0.5, -0.8660253882408142, 1 ],
      [ 6.123234262925839e-17, -1, 1 ] ],
    [ [ 0, 0, 1 ],
      [ 6.123234262925839e-17, -1, 1 ],
      [ 0.5, -0.8660253882408142, 1 ] ],
    [ [ 0, 0, -1 ],
      [ 6.123234262925839e-17, -1, -1 ],
      [ -0.5, -0.8660253882408142, -1 ] ],
    [ [ -0.5, -0.8660253882408142, -1 ],
      [ 6.123234262925839e-17, -1, -1 ],
      [ 6.123234262925839e-17, -1, 1 ],
      [ -0.5, -0.8660253882408142, 1 ] ],
    [ [ 0, 0, 1 ],
      [ -0.5, -0.8660253882408142, 1 ],
      [ 6.123234262925839e-17, -1, 1 ] ],
    [ [ 0, 0, -1 ],
      [ -0.5, -0.8660253882408142, -1 ],
      [ -0.8660253882408142, -0.5, -1 ] ],
    [ [ -0.8660253882408142, -0.5, -1 ],
      [ -0.5, -0.8660253882408142, -1 ],
      [ -0.5, -0.8660253882408142, 1 ],
      [ -0.8660253882408142, -0.5, 1 ] ],
    [ [ 0, 0, 1 ],
      [ -0.8660253882408142, -0.5, 1 ],
      [ -0.5, -0.8660253882408142, 1 ] ],
    [ [ 0, 0, -1 ],
      [ -0.8660253882408142, -0.5, -1 ],
      [ -1, -1.2246468525851679e-16, -1 ] ],
    [ [ -1, -1.2246468525851679e-16, -1 ],
      [ -0.8660253882408142, -0.5, -1 ],
      [ -0.8660253882408142, -0.5, 1 ],
      [ -1, -1.2246468525851679e-16, 1 ] ],
    [ [ 0, 0, 1 ],
      [ -1, -1.2246468525851679e-16, 1 ],
      [ -0.8660253882408142, -0.5, 1 ] ],
    [ [ 0, 0, -1 ],
      [ -1, -1.2246468525851679e-16, -1 ],
      [ -0.8660253882408142, 0.5, -1 ] ],
    [ [ -0.8660253882408142, 0.5, -1 ],
      [ -1, -1.2246468525851679e-16, -1 ],
      [ -1, -1.2246468525851679e-16, 1 ],
      [ -0.8660253882408142, 0.5, 1 ] ],
    [ [ 0, 0, 1 ],
      [ -0.8660253882408142, 0.5, 1 ],
      [ -1, -1.2246468525851679e-16, 1 ] ],
    [ [ 0, 0, -1 ],
      [ -0.8660253882408142, 0.5, -1 ],
      [ -0.5, 0.8660253882408142, -1 ] ],
    [ [ -0.5, 0.8660253882408142, -1 ],
      [ -0.8660253882408142, 0.5, -1 ],
      [ -0.8660253882408142, 0.5, 1 ],
      [ -0.5, 0.8660253882408142, 1 ] ],
    [ [ 0, 0, 1 ],
      [ -0.5, 0.8660253882408142, 1 ],
      [ -0.8660253882408142, 0.5, 1 ] ],
    [ [ 0, 0, -1 ],
      [ -0.5, 0.8660253882408142, -1 ],
      [ -1.8369701465288538e-16, 1, -1 ] ],
    [ [ -1.8369701465288538e-16, 1, -1 ],
      [ -0.5, 0.8660253882408142, -1 ],
      [ -0.5, 0.8660253882408142, 1 ],
      [ -1.8369701465288538e-16, 1, 1 ] ],
    [ [ 0, 0, 1 ],
      [ -1.8369701465288538e-16, 1, 1 ],
      [ -0.5, 0.8660253882408142, 1 ] ],
    [ [ 0, 0, -1 ],
      [ -1.8369701465288538e-16, 1, -1 ],
      [ 0.5, 0.8660253882408142, -1 ] ],
    [ [ 0.5, 0.8660253882408142, -1 ],
      [ -1.8369701465288538e-16, 1, -1 ],
      [ -1.8369701465288538e-16, 1, 1 ],
      [ 0.5, 0.8660253882408142, 1 ] ],
    [ [ 0, 0, 1 ],
      [ 0.5, 0.8660253882408142, 1 ],
      [ -1.8369701465288538e-16, 1, 1 ] ],
    [ [ 0, 0, -1 ],
      [ 0.5, 0.8660253882408142, -1 ],
      [ 0.8660253882408142, 0.5, -1 ] ],
    [ [ 0.8660253882408142, 0.5, -1 ],
      [ 0.5, 0.8660253882408142, -1 ],
      [ 0.5, 0.8660253882408142, 1 ],
      [ 0.8660253882408142, 0.5, 1 ] ],
    [ [ 0, 0, 1 ],
      [ 0.8660253882408142, 0.5, 1 ],
      [ 0.5, 0.8660253882408142, 1 ] ],
    [ [ 0, 0, -1 ],
      [ 0.8660253882408142, 0.5, -1 ],
      [ 1, 2.4492937051703357e-16, -1 ] ],
    [ [ 1, 2.4492937051703357e-16, -1 ],
      [ 0.8660253882408142, 0.5, -1 ],
      [ 0.8660253882408142, 0.5, 1 ],
      [ 1, 2.4492937051703357e-16, 1 ] ],
    [ [ 0, 0, 1 ],
      [ 1, 2.4492937051703357e-16, 1 ],
      [ 0.8660253882408142, 0.5, 1 ] ]
  ]

  t.is(pts.length, 36)
  t.true(comparePolygonsAsPoints(pts, exp))
})

test('cylinder (options)', t => {
  const obs = cylinder({height: 10, radius: 4, segments: 5})
  const pts = geom3.toPoints(obs)
  const exp = [
    [[0, 0, -5], [4, 0, -5], [1.2360680103302002, -3.8042261600494385, -5]],
    [[1.2360680103302002, -3.8042261600494385, -5], [4, 0, -5],
      [4, 0, 5], [1.2360680103302002, -3.8042261600494385, 5]],
    [[0, 0, 5], [1.2360680103302002, -3.8042261600494385, 5], [4, 0, 5]],
    [[0, 0, -5], [1.2360680103302002, -3.8042261600494385, -5], [-3.2360680103302, -2.3511409759521484, -5]],
    [[-3.2360680103302, -2.3511409759521484, -5], [1.2360680103302002, -3.8042261600494385, -5],
      [1.2360680103302002, -3.8042261600494385, 5], [-3.2360680103302, -2.3511409759521484, 5]],
    [[0, 0, 5], [-3.2360680103302, -2.3511409759521484, 5], [1.2360680103302002, -3.8042261600494385, 5]],
    [[0, 0, -5], [-3.2360680103302, -2.3511409759521484, -5], [-3.2360680103302, 2.3511409759521484, -5]],
    [[-3.2360680103302, 2.3511409759521484, -5], [-3.2360680103302, -2.3511409759521484, -5],
      [-3.2360680103302, -2.3511409759521484, 5], [-3.2360680103302, 2.3511409759521484, 5]],
    [[0, 0, 5], [-3.2360680103302, 2.3511409759521484, 5], [-3.2360680103302, -2.3511409759521484, 5]],
    [[0, 0, -5], [-3.2360680103302, 2.3511409759521484, -5], [1.2360680103302002, 3.8042261600494385, -5]],
    [[1.2360680103302002, 3.8042261600494385, -5], [-3.2360680103302, 2.3511409759521484, -5],
      [-3.2360680103302, 2.3511409759521484, 5], [1.2360680103302002, 3.8042261600494385, 5]],
    [[0, 0, 5], [1.2360680103302002, 3.8042261600494385, 5], [-3.2360680103302, 2.3511409759521484, 5]],
    [[0, 0, -5], [1.2360680103302002, 3.8042261600494385, -5], [4, 9.797174820681343e-16, -5]],
    [[4, 9.797174820681343e-16, -5], [1.2360680103302002, 3.8042261600494385, -5],
      [1.2360680103302002, 3.8042261600494385, 5], [4, 9.797174820681343e-16, 5]],
    [[0, 0, 5], [4, 9.797174820681343e-16, 5], [1.2360680103302002, 3.8042261600494385, 5]]
  ]

  t.is(pts.length, 15)
  t.true(comparePolygonsAsPoints(pts, exp))
})
